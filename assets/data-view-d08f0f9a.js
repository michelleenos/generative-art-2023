var _=Object.defineProperty;var w=(i,e,t)=>e in i?_(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var s=(i,e,t)=>(w(i,typeof e!="symbol"?e+"":e,t),t);import{c as r}from"./dom-07b9d998.js";const c=(i,e=2,t=7)=>i.toFixed(e).padStart(t,"Â "),p=i=>typeof i=="number"||Array.isArray(i)&&i.length===2&&i.every(e=>typeof e=="number")||typeof i=="string"||typeof i=="boolean",u=(i,e=2)=>typeof i=="number"?c(i,e):typeof i=="boolean"?i?"true":"false":typeof i=="string"?i:i.map(t=>c(t,e)).join(" ");class f{constructor(e,t){s(this,"el");s(this,"dataEl");s(this,"values",[]);s(this,"parent");s(this,"title");s(this,"signalTriggerAtIndex",(e,t)=>{let l=this.values[e];t&&l.el.style.setProperty("--signal-color",t),l.el.classList.remove("dataview__value--triggered"),l.el.classList.remove("dataview__value--triggered-out"),l.el.classList.add("dataview__value--triggered"),setTimeout(()=>{l.el.classList.add("dataview__value--triggered-out"),l.el.classList.remove("dataview__value--triggered")})});s(this,"update",()=>{this.values.forEach(e=>{if(e.nested){let l=String(e.key).split(".").reduce((a,n)=>a[n],e.object);e.el.innerHTML=u(l,e.decimals);return}e.el.innerHTML=u(e.object[e.key],e.decimals)})});if(this.parent=e,this.el=r("div",{class:"dataview__section"}),this.dataEl=r("div",{class:"dataview__vals"}),t){this.title=t;let l=r("h2",{},t);this.el.appendChild(l)}this.el.appendChild(this.dataEl)}addNested(e,t,l,a=2){let n=t.split(".");try{let d=n.reduce((v,g)=>v[g],e);if(!p(d)){console.error("invalid value",d);return}let o=r("div",{class:"dataview__value-title"},l??t),h=r("div",{class:"dataview__value"});return this.dataEl.append(o,h),this.values.push({el:h,titleEl:o,object:e,key:t,nested:!0,decimals:a}),this.values.length-1}catch(d){console.error("error adding nested",t,d);return}}add(e,t,l=2,a){let n=e[t];if(!p(n)){console.error("invalid value",n);return}let d=r("div",{class:"dataview__value-title"},a??t),o=r("div",{class:"dataview__value"},u(n,l));return this.dataEl.append(d,o),this.values.push({el:o,titleEl:d,object:e,key:t,decimals:l}),this.values.length-1}}class m{constructor(e,t,l,a){s(this,"el");s(this,"values",[]);s(this,"parent");s(this,"title");s(this,"onUpdate");s(this,"update",()=>{this.onUpdate()});if(this.parent=e,this.el=r("div",{class:"dataview__section dataview__section--custom"}),a){this.title=a;let n=r("h2",{},a);this.el.appendChild(n)}this.el.appendChild(t),this.onUpdate=l}}class L{constructor(){s(this,"el");s(this,"sections",[]);s(this,"toggle");s(this,"_visible",!0);s(this,"show",()=>(this.toggle.innerHTML="hide data",this.el.classList.remove("hidden"),this._visible=!0,this));s(this,"hide",()=>(this.toggle.innerHTML="show data",this.el.classList.add("hidden"),this._visible=!1,this));s(this,"onToggle",()=>{this._visible?this.hide():this.show()});s(this,"update",()=>{this._visible&&this.sections.forEach(e=>e.update())});this.toggle=r("button",{class:"dataview__toggle"},"hide data"),this.el=r("div",{class:"dataview"},[this.toggle]),document.body.appendChild(this.el),this.toggle.addEventListener("click",this.onToggle)}createSection(e){let t=new f(this,e);return this.sections.push(t),this.el.appendChild(t.el),t}createCustomSection(e,t,l){let a=new m(this,e,t,l);return this.sections.push(a),this.el.appendChild(a.el),a}}export{L as D};
