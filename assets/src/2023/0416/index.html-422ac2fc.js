var Y=Object.defineProperty;var F=(t,r,e)=>r in t?Y(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var d=(t,r,e)=>(F(t,typeof r!="symbol"?r+"":r,e),e);import"../../../modulepreload-polyfill-3cfb730f.js";/* empty css                     */import{p as o}from"../../../p5.min-89a01bf6.js";import"../../../p5.sound-2825c463.js";import"../../../_commonjsHelpers-725317a4.js";import"../../../_commonjs-dynamic-modules-302442b1.js";const u={c1:36,"c#1":37,db1:37,d1:38,"d#1":39,eb1:39,e1:40,f1:41,"f#1":42,gb1:42,g1:43,"g#1":44,ab1:44,a1:45,"a#1":46,bb1:46,b1:47,c2:48,"c#2":49,db2:49,d2:50,"d#2":51,eb2:51,e2:52,f2:53,"f#2":54,gb2:54,g2:55,"g#2":56,ab2:56,a2:57,"a#2":58,bb2:58,b2:59,c3:60,"c#3":61,db3:61,d3:62,"d#3":63,eb3:63,e3:64,f3:65,"f#3":66,gb3:66,g3:67,"g#3":68,ab3:68,a3:69,"a#3":70,bb3:70,b3:71,c4:72,"c#4":73,db4:73,d4:74,"d#4":75,eb4:75,e4:76,f4:77,"f#4":78,gb4:78,g4:79,"g#4":80,ab4:80,a4:81,"a#4":82,bb4:82,b4:83,c5:84,"c#5":85,db5:85,d5:86,"d#5":87,eb5:87,e5:88,f5:89,"f#5":90,gb5:90,g5:91,"g#5":92,ab5:92,a5:93,"a#5":94,bb5:94,b5:95,c6:96,"c#6":97,db6:97,d6:98,"d#6":99,eb6:99,e6:100,f6:101,"f#6":102,gb6:102,g6:103,"g#6":104,ab6:104,a6:105,"a#6":106,bb6:106,b6:107,c7:108,"c#7":109,db7:109,d7:110,"d#7":111,e7:112,f7:113,"f#7":114,gb7:114,g7:115,"g#7":116,ab7:116,a7:117,"a#7":118,bb7:118,b7:119},l={d7:["d2","f2","a2","c3","d3","f3","a3"],Csus:["c2","e2","f2","g2","c3","f3","g3"],E7:["d2","e2","e2","g#2","b2","e3","g#3"],a7:["c2","e2","g2","a2","c3","e3","g3"],F:["c2","f2","g2","a2","c3","f3","a3"],G9:["d2","f2","a2","b2","d3","g3","b3"]};let m=[l.Csus,l.d7,l.a7,l.F,l.G9];new o(t=>{let r,e=[],b,c,g;class y{constructor(i=200,a=3,h=2,n=8){d(this,"radius");d(this,"osc");d(this,"_freq");d(this,"x");d(this,"y");d(this,"addX");d(this,"addY");d(this,"playing",!1);d(this,"touching",!1);d(this,"env",new o.Envelope);d(this,"alphaOuter",0);d(this,"lastTriggered",-1/0);d(this,"hue");d(this,"freqHue");this.radius=n,this.osc=new o.Oscillator(i,"triangle"),this.x=t.random(0,t.width),this.y=t.random(0,t.height),this.addX=a,this.addY=h,this.osc.amp(0),this.osc.start(),this._freq=i,this.freqHue=t.map(t.freqToMidi(i),c,g,0,360),this.hue=this.freqHue;let x=.1,w=.15,v=.05,T=.02,k=.05,X=0;this.env.set(x,w,v,T,k,X)}move(){this.x+=this.addX,this.y+=this.addY,this.x>t.width-this.radius&&(this.addX=-t.abs(this.addX)),this.y>t.height-this.radius&&(this.addY=-t.abs(this.addY)),this.x<this.radius&&(this.addX=t.abs(this.addX)),this.y<this.radius&&(this.addY=t.abs(this.addY))}set freq(i){this._freq=i,this.osc.freq(i,0),this.freqHue=t.map(t.freqToMidi(i),c,g,0,360)}play(i){this.playing||(this.lastTriggered=i,this.env.triggerAttack(this.osc,0),this.alphaOuter=1,this.playing=!0)}stop(i){this.playing&&(this.lastTriggered=i,this.env.triggerRelease(this.osc,0),this.playing=!1)}draw(){this.hue=t.lerp(this.hue,this.freqHue,.1),this.playing&&(t.fill(this.hue,80,50,.3),t.circle(this.x,this.y,this.radius*4)),t.fill(this.hue,80,50,1),t.circle(this.x,this.y,this.radius*2)}distanceFrom(i){return t.dist(this.x,this.y,i.x,i.y)}}let q=m.map(s=>s.map(i=>u[i])),f=m.map(s=>s.map(i=>t.midiToFreq(u[i])));t.setup=function(){t.createCanvas(400,400),r=(t.width+t.height)*.15,t.colorMode(t.HSL);let s=q.reduce((a,h)=>a.concat(h),[]);c=t.min(s),g=t.max(s),b=new o.SoundLoop(()=>{let a=t.random(f);for(let h=0;h<e.length;h++){let n=a[h%a.length];e[h].freq=n}},3),b.start();let i=f[0];for(let a=0;a<7;a++){let h=i[a%i.length];e.push(new y(h,t.random(.2,2),t.random(.2,2)))}},t.draw=function(){t.background(10),t.noStroke();for(let s=0;s<e.length;s++)e[s].move(),e[s].draw();for(let s=0;s<e.length;s++){let i=!1;for(let a=0;a<e.length;a++){if(s==a)continue;e[s].distanceFrom(e[a])<r&&(t.stroke(0,100,100,.2),t.strokeWeight(1),t.line(e[s].x,e[s].y,e[a].x,e[a].y),i=!0)}e[s].touching=i,e[s].touching?e[s].play(t.millis()):e[s].stop(t.millis())}}});
