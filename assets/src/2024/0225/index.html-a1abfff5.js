var y=Object.defineProperty;var p=(l,t,i)=>t in l?y(l,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[t]=i;var h=(l,t,i)=>(p(l,typeof t!="symbol"?t+"":t,i),i);import"../../../modulepreload-polyfill-3cfb730f.js";/* empty css                     */import{p as w}from"../../../p5.min-89a01bf6.js";import{r as u}from"../../../utils-410b772c.js";import{t as x}from"../../../tweakpane-9ece380b.js";import"../../../_commonjsHelpers-725317a4.js";import"../../../_commonjs-dynamic-modules-302442b1.js";class b{constructor(t,i,e,s){h(this,"cells",[]);h(this,"width");h(this,"height");h(this,"count");h(this,"cellSize");h(this,"setCells",()=>{this.cells=[];for(let t=0;t<this.count.x;t++){let i=[];for(let e=0;e<this.count.y;e++){let s=t===0||t===this.count.x-1,o=e===0||e===this.count.y-1,n=s&&o?3:s||o?5:8;i.push({posx:(t-this.count.x/2+.5)*this.cellSize.x,posy:(e-this.count.y/2+.5)*this.cellSize.y,x:t,y:e,weight:n,neighbors:[],neighbors90:[],gravity:1})}this.cells.push(i)}});h(this,"setCellNeighbors",()=>{for(let t=0;t<this.count.x;t++){let i=t>0?t-1:null,e=t<this.count.x-1?t+1:null;for(let s=0;s<this.count.y;s++){let o=s>0?s-1:null,n=s<this.count.y-1?s+1:null,a=this.cells[t][s],g=[i!==null&&this.cells[i][s],o!==null&&this.cells[t][o],e!==null&&this.cells[e][s],n!==null&&this.cells[t][n]],r=[...g,i!==null&&o!==null&&this.cells[i][o],i!==null&&n!==null&&this.cells[i][n],e!==null&&o!==null&&this.cells[e][o],e!==null&&n!==null&&this.cells[e][n]];a.neighbors90.push(...g.filter(c=>c)),a.neighbors.push(...r.filter(c=>c)),a.weight=1,a.gravity=a.neighbors.length+1}}});h(this,"getRandom",()=>{let t=Math.floor(Math.random()*this.count.x),i=Math.floor(Math.random()*this.count.y);return this.cells[t][i]});this.width=t,this.height=i,this.count={x:e,y:s},this.cellSize={x:t/e,y:i/s},this.setCells(),this.setCellNeighbors()}weighLess(t,i){let e=typeof t=="number"?this.cells[t][i]:t,s=e.weight;e.weight=Math.max(0,s-1),e.neighbors90.forEach(o=>o.gravity--)}weighMore(t,i){let e=typeof t=="number"?this.cells[t][i]:t,s=e.weight;e.weight=Math.min(2,s+1),e.neighbors90.forEach(o=>o.gravity++)}updateGravity(t,i){let e=typeof t=="number"?this.cells[t][i]:t;e.gravity=e.neighbors.reduce((s,o)=>s+o.weight,1)}getNext(t,i){let e=typeof t=="number"?this.cells[t][i]:t,s=[];if(e.neighbors90.forEach(o=>{s.push(o)}),s.length===0){console.log("no options",e);return}return u(s)}getNextWeighted(t,i){let e=typeof t=="number"?this.cells[t][i]:t,s=[];if(e.neighbors90.forEach(o=>{if(o.weight>0)for(let n=0;n<o.gravity;n++)s.push(o)}),s.length===0){console.log("no options",e);return}return u(s)}}class k{constructor(t,{color:i,maxPoints:e=10,thickness:s=10,speed:o=3,symmetry:n="reflect",useWeights:a=!0}){h(this,"grid");h(this,"points",[]);h(this,"color");h(this,"maxPoints");h(this,"lastAdd",0);h(this,"lastTime",0);h(this,"progress",0);h(this,"thickness");h(this,"speed");h(this,"useWeights");h(this,"shrinking",!1);h(this,"symmetry");h(this,"addPoint",()=>{let t=this.points.length<1?this.grid.getRandom():this.useWeights?this.grid.getNextWeighted(this.points[this.points.length-1]):this.grid.getNext(this.points[this.points.length-1]);if(this.points.length+1>this.maxPoints){let i=this.points.shift();this.useWeights&&this.grid.weighMore(i)}if(!t){this.shrinking=!0;return}this.points.push(t),this.useWeights&&this.grid.weighLess(t)});h(this,"drawLine",t=>{t.beginShape();let i=this.points.length;for(let e=0;e<i;e++){let s=this.points[e];if(e===0&&(i===this.maxPoints||this.shrinking&&i>1)){let o=this.points[e+1],n=t.lerp(s.posx,o.posx,this.progress),a=t.lerp(s.posy,o.posy,this.progress);t.vertex(n,a)}else if(e>0&&e===i-1&&!this.shrinking){let o=this.points[e-1],n=t.lerp(o.posx,s.posx,this.progress),a=t.lerp(o.posy,s.posy,this.progress);t.vertex(n,a)}else t.vertex(s.posx,s.posy)}t.endShape()});h(this,"draw",t=>{t.stroke(this.color),t.strokeWeight(this.thickness),t.noFill(),t.push(),this.drawLine(t),this.symmetry==="rotate"?(t.rotate(t.PI/2),this.drawLine(t),t.rotate(t.PI/2),this.drawLine(t),t.rotate(t.PI/2),this.drawLine(t)):this.symmetry==="reflect"&&(t.scale(-1,1),this.drawLine(t),t.scale(1,-1),this.drawLine(t),t.scale(-1,1),this.drawLine(t)),t.pop()});h(this,"update",(t,i)=>{let e=i-this.lastTime;this.lastTime=i;let s=e/1e3;if(this.progress+=s*this.speed,this.progress>=1){if(this.shrinking)if(this.points.length>0){let o=this.points.shift();this.useWeights&&this.grid.weighMore(o)}else this.shrinking=!1,this.addPoint();else this.addPoint();this.progress=0}this.draw(t)});this.grid=t,this.color=i,this.maxPoints=e,this.speed=o,this.symmetry=n,this.thickness=s,this.useWeights=a;for(let g=0;g<u(2,this.maxPoints);g++)this.addPoint()}}let f=["#ff0000","#00ff00","#0000ff"];new w(l=>{const t={showGravity:!1,showCells:!0,lines:3,background:"rgba(0,0,0, 1)",cellsColor:"rgba(255,255,255, 1)",symmetry:"reflect",blendMode:l.EXCLUSION};let i,e,s=[],o=new x.Pane;function n(){i=l.min(l.width,l.height)*.7,e=new b(i,i,12,12);for(let r=0;r<t.lines;r++)s.push(new k(e,{color:f[r%f.length],thickness:e.cellSize.x*.7,maxPoints:15}));g()}l.setup=function(){l.createCanvas(window.innerWidth,window.innerHeight),l.strokeCap(l.PROJECT),l.rectMode(l.CENTER),n()},l.draw=function(){let r=l.millis();a(r)};function a(r){l.background(t.background),l.push(),l.blendMode(t.blendMode),l.noStroke(),l.translate(l.width/2,l.height/2),t.showCells&&e.cells.forEach(c=>{c.forEach(d=>{l.push(),l.translate(d.posx,d.posy);let m=l.color(t.cellsColor);l.fill(m),l.rect(0,0,e.cellSize.x*.7),l.pop()})}),s.forEach(c=>c.update(l,r)),l.pop()}function g(){let r=o.addFolder({title:"settings"});r.addInput(t,"symmetry",{options:{reflect:"reflect",rotate:"rotate",none:"none"}}).on("change",c=>s.forEach(d=>d.symmetry=c.value)),r.addInput(s[0],"color",{label:"line1"}),r.addInput(s[1],"color",{label:"line2"}),r.addInput(s[2],"color",{label:"line3"}),r.addButton({title:"clear"}).on("click",()=>l.clear())}},document.getElementById("sketch")??void 0);
