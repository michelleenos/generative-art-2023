var f=Object.defineProperty;var g=(n,t,s)=>t in n?f(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var l=(n,t,s)=>(g(n,typeof t!="symbol"?t+"":t,s),s);import"../../../modulepreload-polyfill-3cfb730f.js";/* empty css                     */import{r as p}from"../../../utils-410b772c.js";import{t as I}from"../../../tweakpane-9ece380b.js";import{p as w}from"../../../p5.min-89a01bf6.js";import"../../../_commonjsHelpers-725317a4.js";import"../../../_commonjs-dynamic-modules-302442b1.js";class m{constructor({maxPoints:t=10,color:s,size:o}){l(this,"points",[]);l(this,"maxPoints");l(this,"color");l(this,"size");l(this,"dead",!1);l(this,"dying",!1);l(this,"life",1);l(this,"lengthAtDying",1);l(this,"maxTries",5);l(this,"getDir",()=>p([[0,1],[0,-1],[-1,-1],[1,1],[1,0],[-1,0]]));l(this,"outOfBounds",(t,s)=>t<0||s<0||t>=this.size||s>=this.size);l(this,"includes",(t,s)=>this.points.some(([o,h])=>o===t&&h===s));l(this,"getNext",()=>{let[t,s]=this.points[this.points.length-1],[o,h]=this.getDir(),i=t+o,e=s+h;return!this.outOfBounds(i,e)&&!this.includes(i,e)?[i,e]:null});l(this,"step",()=>{if(this.dying){this.life*=.9,this.points.shift(),this.points.length===0&&(this.dead=!0);return}let t=0,s=this.getNext();for(;!s&&t<this.maxTries;)s=this.getNext(),t++;s?(this.points.push(s),this.points.length>this.maxPoints&&this.points.shift()):(this.dying=!0,this.lengthAtDying=this.points.length)});this.maxPoints=t,this.color=s,this.size=o,this.points.push([Math.floor(o/2),Math.floor(o/2)])}}let r={count:2,countInner:15,walkers:4,maxPoints:10,symmetry:"reflection",style:"lines"};const y="083d77-f4d35e-5adbff-550527-f95738".split("-").map(n=>"#"+n),u=new I.Pane;class x{constructor({cells:t=9,pos:s,sizeOuter:o,palette:h,walkersCount:i=2,symmetry:e="rotation",style:c="lines"}){l(this,"walkers",[]);l(this,"walkersCount");l(this,"sizeOuter");l(this,"sizeInner");l(this,"cells");l(this,"pos");l(this,"palette");l(this,"colorIndex",0);l(this,"stepsCount",0);l(this,"stepsBetweenAdd");l(this,"stepsLastAdd",0);l(this,"symmetry");l(this,"style");l(this,"add",()=>{let t=this.palette[this.colorIndex];this.walkers.push(new m({color:t,size:this.cells,maxPoints:r.maxPoints})),this.colorIndex=(this.colorIndex+1)%this.palette.length,this.stepsLastAdd=this.stepsCount});l(this,"rect",(t,s,o)=>{let h=t.createVector(s,o);h.sub(this.cells/2,this.cells/2).mult(this.sizeInner).add(this.sizeInner/2,this.sizeInner/2),t.rect(h.x,h.y,this.sizeInner*.9)});l(this,"line",(t,s,o,h,i)=>{let e=t.createVector(s,o),c=t.createVector(h,i);e.sub(this.cells/2,this.cells/2).mult(this.sizeInner).add(this.sizeInner/2,this.sizeInner/2),c.sub(this.cells/2,this.cells/2).mult(this.sizeInner).add(this.sizeInner/2,this.sizeInner/2),t.line(e.x,e.y,c.x,c.y)});this.cells=t,this.sizeOuter=o,this.walkersCount=i,this.sizeInner=o/t,this.pos=s,this.symmetry=e,this.palette=[...h],this.style=c,this.stepsBetweenAdd=Math.floor(Math.random()*10)+10,this.add()}draw(t){this.stepsCount++,t.push(),t.translate(this.pos.x,this.pos.y),t.fill(240),t.noStroke(),t.rect(0,0,this.sizeOuter),this.walkers.forEach((s,o)=>{s.step(),s.dead&&(this.walkers[o]=new m({color:this.palette[this.colorIndex],size:this.cells,maxPoints:r.maxPoints}),this.colorIndex=(this.colorIndex+1)%this.palette.length);let h=t.color(s.color);h=t.lerpColor(h,t.color(240),1-s.life),this.style==="rects"?(t.fill(h),s.points.forEach(([i,e])=>{this.symmetry==="rotation"?(this.rect(t,i,e),this.rect(t,this.cells-e-1,i),this.rect(t,e,this.cells-i-1),this.rect(t,this.cells-i-1,this.cells-e-1)):(this.rect(t,i,e),this.rect(t,this.cells-i-1,e),this.rect(t,i,this.cells-e-1),this.rect(t,this.cells-i-1,this.cells-e-1))})):(t.stroke(h),t.strokeWeight(this.sizeInner*.5),s.points.forEach(([i,e],c)=>{if(c===0)return;let[a,d]=s.points[c-1];this.symmetry==="rotation"?(this.line(t,a,d,i,e),this.line(t,this.cells-d-1,a,this.cells-e-1,i),this.line(t,d,this.cells-a-1,e,this.cells-i-1),this.line(t,this.cells-a-1,this.cells-d-1,this.cells-i-1,this.cells-e-1)):(this.line(t,a,d,i,e),this.line(t,this.cells-a-1,d,this.cells-i-1,e),this.line(t,a,this.cells-d-1,i,this.cells-e-1),this.line(t,this.cells-a-1,this.cells-d-1,this.cells-i-1,this.cells-e-1))}))}),this.walkers.length<this.walkersCount&&this.stepsCount-this.stepsLastAdd>this.stepsBetweenAdd&&this.add(),t.pop()}}new w(n=>{let t,s=[];function o(){t=n.min(n.width,n.height)*.9;let h=n.floor(t/r.count),i=y.map(e=>n.color(e));s=[];for(let e=-(r.count/2);e<r.count/2;e++)for(let c=-(r.count/2);c<r.count/2;c++)s.push(new x({pos:n.createVector((e+.5)*h,(c+.5)*h),sizeOuter:h*.9,cells:r.countInner,walkersCount:r.walkers,palette:n.shuffle(i),symmetry:r.symmetry,style:r.style}))}u.addInput(r,"count",{min:1,max:10,step:1}).on("change",o),u.addInput(r,"countInner",{min:1,max:30,step:1}).on("change",o),u.addInput(r,"walkers",{min:1,max:10,step:1}).on("change",o),u.addInput(r,"maxPoints",{min:1,max:30,step:1}).on("change",o),u.addInput(r,"symmetry",{options:{reflection:"reflection",rotation:"rotation"}}).on("change",h=>{s.forEach(i=>i.symmetry=h.value)}),u.addInput(r,"style",{options:{lines:"lines",rects:"rects"}}).on("change",h=>{s.forEach(i=>i.style=h.value)}),n.setup=function(){n.createCanvas(window.innerWidth,window.innerHeight),o(),n.frameRate(10),n.rectMode(n.CENTER)},n.draw=function(){n.background(250),n.translate(n.width/2,n.height/2),s.forEach(h=>h.draw(n))}},document.getElementById("sketch")??void 0);
