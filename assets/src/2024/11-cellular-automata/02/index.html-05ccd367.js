var g=Object.defineProperty;var w=(r,t,e)=>t in r?g(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var l=(r,t,e)=>(w(r,typeof t!="symbol"?t+"":t,e),e);import"../../../../modulepreload-polyfill-3cfb730f.js";/* empty css                        */import{c as x}from"../../../../index-8d178fc0.js";import{S}from"../../../../sizes-34512445.js";import{l as z}from"../../../../loop-9a51de3b.js";import{a as M}from"../../../../lil-gui.esm-da8e181f.js";import{r as n}from"../../../../utils-410b772c.js";import{c as u}from"../../../../index-168b6c61.js";import"../../../../_commonjsHelpers-725317a4.js";let p=new S,{ctx:y}=x(p.width,p.height);class G{constructor({cols:t,seed:e="center",rule:s=90}){l(this,"generation",0);l(this,"cells");l(this,"ruleset");l(this,"seed");l(this,"getSeedGeneration",t=>{let e=new Array(t).fill(0);switch(this.seed){case"center":e[Math.floor(t/2)]=1;break;case"specks":let s=Math.floor(n(5,10));for(;s<t;)e[s]=1,s+=Math.floor(n(5,10));break;case"flecks":let i=Math.floor(n(1,6)),h=Math.floor(n(3,8));for(;i<t;)e[i]=1,h--,h<=0?(i+=Math.floor(n(5,10)),h=Math.floor(n(3,8))):i++;break;case"random":e=e.map(()=>Math.random()>.5?1:0);break}return e});l(this,"nextGeneration",()=>{let t=this.cells,e=new Array(t.length).fill(0);for(let s=0;s<t.length;s++){let i=t[s-1]||0,h=t[s],d=t[s+1]||0,c=parseInt(`${i}${h}${d}`,2);e[s]=this.ruleset[7-c]}this.cells=e,this.generation++});this.seed=e,this.cells=this.getSeedGeneration(t),this.rule=s}get cols(){return this.cells.length}set cols(t){this.changeCols(t)}get rule(){return parseInt(this.ruleset.join(""),2)}set rule(t){let e=t.toString(2).padStart(8,"0");this.ruleset=e.split("").map(s=>parseInt(s))}stepCount(t){let e=0;for(;e<t;)this.nextGeneration(),e++}restart(){this.cells=this.getSeedGeneration(this.cells.length),this.generation=0}changeCols(t){let e=this.cells.length;if(t>e){let s=t-e,i=new Array(Math.floor(s/2)).fill(0),h=new Array(Math.ceil(s/2)).fill(0);this.cells=[...i,...this.cells,...h]}else{let s=e-t;this.cells=this.cells.slice(Math.floor(s/2),this.cells.length-Math.ceil(s/2))}}}class b extends G{constructor({cols:e,sizes:s,ctx:i,seed:h="center",rule:d,colors:c}){super({cols:e,seed:h,rule:d});l(this,"sizes");l(this,"ctx");l(this,"maxRows");l(this,"paused",!1);l(this,"lastTime",0);l(this,"frameRate",50);l(this,"cellSize");l(this,"topOffset",0);l(this,"colors",["#fff","#000"]);l(this,"bg",()=>{this.ctx.fillStyle=this.colors[0],this.ctx.fillRect(0,0,this.sizes.width,this.sizes.height)});l(this,"firstDraw",()=>{this.bg(),this.drawGeneration()});l(this,"drawGeneration",()=>{let{ctx:e}=this,s=this.cells;for(let i=0;i<s.length;i++)e.fillStyle=s[i]===1?this.colors[1]:this.colors[0],e.fillRect(i*this.cellSize,this.topOffset,this.cellSize,this.cellSize);this.topOffset+=this.cellSize,this.topOffset>=this.sizes.height&&(this.topOffset=0)});l(this,"loop",e=>{e-this.lastTime>1e3/this.frameRate&&(this.lastTime=e,this.paused||this.step())});l(this,"pause",()=>{this.paused=!0});l(this,"play",()=>{this.paused=!1});this.cellSize=Math.floor(s.width/e),this.maxRows=Math.floor(s.height/this.cellSize),this.sizes=s,this.ctx=i,c&&(this.colors=c),this.firstDraw()}set cols(e){super.cols=e,this.cellSize=Math.ceil(this.sizes.width/e),this.maxRows=Math.ceil(this.sizes.height/this.cellSize)}get cols(){return super.cols}step(){this.nextGeneration(),this.drawGeneration()}restart(){super.restart(),this.topOffset=0,this.firstDraw()}}const a=new b({cols:50,sizes:p,ctx:y,colors:[u.random().hex(),u.random().hex()]}),m={step10:()=>a.stepCount(10),step20:()=>a.stepCount(20),step:()=>a.step(),cols:a.cols},o=new M;o.add(a,"seed",["center","random","specks","flecks"]).onChange(()=>a.restart());o.add(a,"rule",0,255,1);o.add(a,"frameRate",1,100,1);o.add(a,"restart");o.add(a,"generation").disable().listen();o.add(m,"cols",10,200,1).onFinishChange(r=>{a.cols=r});let f=o.addFolder("play/pause/step").close();f.add(a,"pause");f.add(a,"play");f.add(m,"step");f.add(m,"step10");z(a.loop);window.automata=a;
