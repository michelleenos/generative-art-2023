var u=Object.defineProperty;var d=(l,t,e)=>t in l?u(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var n=(l,t,e)=>(d(l,typeof t!="symbol"?t+"":t,e),e);import"../../../modulepreload-polyfill-3cfb730f.js";/* empty css                     */import{p as c}from"../../../p5.min-89a01bf6.js";import{r as a,s as m}from"../../../utils-410b772c.js";import{t as p}from"../../../tweakpane-9ece380b.js";import"../../../_commonjsHelpers-725317a4.js";import"../../../_commonjs-dynamic-modules-302442b1.js";class f{constructor(t,e,s=45){n(this,"cells",[]);n(this,"_size");n(this,"_count");n(this,"_divSize");n(this,"angles");n(this,"setCells",()=>{this.cells=[];for(let t=0;t<this._count;t++){let e=[];for(let s=0;s<this._count;s++)e.push({posx:(t-this._count/2+.5)*this._divSize,posy:(s-this._count/2+.5)*this._divSize,x:t,y:s,weight:1,neighbors:[],gravity:1});this.cells.push(e)}});n(this,"drawCells",(t,e=!1)=>{this.cells.forEach(s=>{s.forEach(i=>{t.push(),t.translate(i.posx,i.posy),t.fill(255,20),t.rect(0,0,t.min(this._divSize,this._divSize)*.8),e&&(t.fill(255),t.text("g: "+i.gravity,0,0),t.text("w: "+i.weight,0,10)),t.pop()})})});n(this,"setCellNeighbors",()=>{for(let t=0;t<this._count;t++){let e=t>0?t-1:null,s=t<this._count-1?t+1:null;for(let i=0;i<this._count;i++){let h=i>0?i-1:null,r=i<this._count-1?i+1:null,o=this.cells[t][i];o.neighbors=[],e!==null&&o.neighbors.push(this.cells[e][i]),h!==null&&o.neighbors.push(this.cells[t][h]),s!==null&&o.neighbors.push(this.cells[s][i]),r!==null&&o.neighbors.push(this.cells[t][r]),this.angles===45&&(e!==null&&h!==null&&o.neighbors.push(this.cells[e][h]),e!==null&&r!==null&&o.neighbors.push(this.cells[e][r]),s!==null&&h!==null&&o.neighbors.push(this.cells[s][h]),s!==null&&r!==null&&o.neighbors.push(this.cells[s][r])),o.weight=1,o.gravity=o.neighbors.length+1}}});n(this,"getRandom",()=>{let t=Math.floor(Math.random()*this._count),e=Math.floor(Math.random()*this._count);return this.cells[t][e]});this._size=t,this._count=e,this._divSize=t/this._count,this.angles=s,this.setCells(),this.setCellNeighbors()}get divSize(){return this._divSize}get size(){return this._size}set size(t){this._size=t,this._divSize=t/this._count,this.setCells(),this.setCellNeighbors()}weighLess(t,e){let s=typeof t=="number"?this.cells[t][e]:t;s.weight=Math.max(0,s.weight-1)}weighMore(t,e){let s=typeof t=="number"?this.cells[t][e]:t;s.weight=Math.min(2,s.weight+1)}updateGravity(t,e){let s=typeof t=="number"?this.cells[t][e]:t;s.gravity=s.neighbors.reduce((i,h)=>i+h.weight,1)}getNext(t,e){let s=typeof t=="number"?this.cells[t][e]:t,i=[];if(s.neighbors.forEach(h=>{i.push(h)}),i.length!==0)return a(i)}getNextWeighted(t,e){let s=typeof t=="number"?this.cells[t][e]:t,i=[];if(s.neighbors.forEach(h=>{if(h.weight>0){this.updateGravity(h);for(let r=0;r<h.gravity;r++)i.push(h)}}),i.length!==0)return a(i)}}class w{constructor(t,{color:e,maxPoints:s=10,thickness:i=10,speed:h=3,symmetry:r="reflect",useWeights:o=!0}){n(this,"grid");n(this,"points",[]);n(this,"color");n(this,"maxPoints");n(this,"lastTime",0);n(this,"progress",0);n(this,"thickness");n(this,"speed");n(this,"useWeights");n(this,"shrinking",!1);n(this,"symmetry");n(this,"alphaLen",3);n(this,"addPoint",()=>{let t=this.points.length<1?this.grid.getRandom():this.useWeights?this.grid.getNextWeighted(this.points[this.points.length-1]):this.grid.getNext(this.points[this.points.length-1]);if(this.points.length+1>this.maxPoints){let e=this.points.shift();this.useWeights&&this.grid.weighMore(e)}if(!t){this.shrinking=!0;return}this.points.push(t),this.useWeights&&this.grid.weighLess(t)});n(this,"drawLine",t=>{t.push(),t.beginShape();let e=this.points.length;for(let s=0;s<e;s++){let i=this.points[s];if(s===0&&(e===this.maxPoints||this.shrinking&&e>1)){let h=this.points[s+1],r=t.lerp(i.posx,h.posx,this.progress),o=t.lerp(i.posy,h.posy,this.progress);t.vertex(r,o)}else if(s>0&&s===e-1&&!this.shrinking){let h=this.points[s-1],r=t.lerp(h.posx,i.posx,this.progress),o=t.lerp(h.posy,i.posy,this.progress);t.vertex(r,o)}else t.vertex(i.posx,i.posy)}t.endShape(),t.pop()});n(this,"draw",t=>{let e=t.color(this.color);if(this.shrinking&&this.points.length<=this.alphaLen){let s=255/(this.alphaLen-1),i=(this.points.length-1)*s;i-=this.progress*s,e.setAlpha(i)}t.stroke(e),t.strokeWeight(this.thickness),t.noFill(),t.push(),this.drawLine(t),this.symmetry==="rotate"?(t.rotate(t.PI/2),this.drawLine(t),t.rotate(t.PI/2),this.drawLine(t),t.rotate(t.PI/2),this.drawLine(t)):this.symmetry==="reflect"&&(t.scale(-1,1),this.drawLine(t),t.scale(1,-1),this.drawLine(t),t.scale(-1,1),this.drawLine(t)),t.pop()});this.grid=t,this.color=e,this.maxPoints=s,this.speed=h,this.symmetry=r,this.thickness=i,this.useWeights=o;for(let g=0;g<a(2,this.maxPoints);g++)this.addPoint()}update(t){let e=t-this.lastTime;this.lastTime=t;let s=e/1e3;if(this.progress+=s*this.speed,this.progress>=1){if(this.shrinking)if(this.points.length>1){let i=this.points.shift();this.useWeights&&this.grid.weighMore(i)}else{for(this.shrinking=!1;this.points.length;){let i=this.points.pop();this.useWeights&&this.grid.weighMore(i)}this.addPoint()}else this.addPoint();this.progress=0}}}let _=["#ff4d4d","#ffcc22","#11dd77","#44aaee","#bb66ee"];class y{constructor(t,e=4){n(this,"background","#0e1428");n(this,"_size");n(this,"_cellsCount");n(this,"_cellSize");n(this,"_cellDiv");n(this,"items",[]);n(this,"linesCount",2);n(this,"_symmetry","reflect");n(this,"_weights",!1);n(this,"_speed",3);n(this,"_maxPointsPerLine",4);n(this,"_showGravity",!1);n(this,"setupItems",()=>{for(let t=0;t<this._cellsCount;t++)for(let e=0;e<this._cellsCount;e++){let s=new f(this._cellSize*.8,this._cellDiv),i=[],h=m(_);for(let r=0;r<this.linesCount;r++){let o=new w(s,{color:h[r%h.length],thickness:s.divSize*.35,maxPoints:this._maxPointsPerLine,useWeights:this._weights,speed:a(this._speed*.75,this._speed*1.25),symmetry:this._symmetry});i.push(o)}this.items.push({grid:s,lines:i,x:(t-this._cellsCount/2+.5)*this._cellSize,y:(e-this._cellsCount/2+.5)*this._cellSize})}});n(this,"show",(t,e)=>{e.push(),e.background(this.background),e.noStroke(),e.translate(e.width/2,e.height/2),this.items.forEach(({lines:s})=>{s.forEach(i=>i.update(t))}),this.items.forEach(({lines:s,x:i,y:h,grid:r})=>{e.push(),e.translate(i,h),r.drawCells(e,this._showGravity),s.forEach(o=>o.draw(e)),e.pop()}),e.pop()});this._size=t,this._cellSize=t/e,this._cellsCount=e,this._cellDiv=4,this.setupItems()}get symmetry(){return this._symmetry}set symmetry(t){this._symmetry=t,this.updateLinesProp("symmetry",t)}get weights(){return this._weights}set weights(t){this._weights=t,this.updateLinesProp("useWeights",t)}get speed(){return this._speed}set speed(t){this._speed=t,this.updateLinesProp("speed",t)}get maxPointsPerLine(){return this._maxPointsPerLine}set maxPointsPerLine(t){this._maxPointsPerLine=t,this.updateLinesProp("maxPoints",t)}get showGravity(){return this._showGravity}set showGravity(t){this._showGravity=t}get size(){return this._size}set size(t){this._size=t,this._cellSize=t/this._cellsCount,this.items=[],this.setupItems()}updateLinesProp(t,e){this.items.forEach(({lines:s})=>{s.forEach(i=>{i[t]=e})})}}new c(l=>{let t=new p.Pane,e;function s(){let h=l.min(l.width,l.height)*.9;e=new y(h,4),i()}l.setup=function(){l.createCanvas(window.innerWidth,window.innerHeight),l.strokeCap(l.ROUND),l.strokeJoin(l.ROUND),l.rectMode(l.CENTER),s(),window.drawing=e},l.draw=function(){let h=l.millis();e.show(h,l)},l.windowResized=function(){l.resizeCanvas(window.innerWidth,window.innerHeight);let h=l.min(l.width,l.height)*.9;e.size=h};function i(){let h=t.addFolder({title:"settings"});h.addInput(e,"symmetry",{options:{reflect:"reflect",rotate:"rotate",none:"none"}}),h.addInput(e,"weights"),h.addInput(e,"speed",{min:1,max:10,step:.1}),h.addInput(e,"maxPointsPerLine",{min:3,max:20,step:1}),h.addInput(e,"background",{input:"color"}),h.addInput(e,"showGravity")}},document.getElementById("sketch")??void 0);
